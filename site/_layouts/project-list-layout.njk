---
layout: base-layout.njk
---
<div class="content project-list-page">
  <div class="fixed-navbar">
    {% include "navbar.njk" %}
  </div>
  {# <h1>Projects</h1> #}
  <div id="project-list">
    {%- for project in collections.project -%}
      <div class="project-list-item" data-color="{{ project.data.color }}">
        <div class="center">
          <h2>{{ project.data.title }}</h2>
          {% if project.data.thumbnail %}
            {% image project.fileSlug+"/"+project.data.thumbnail, project.data.title, 1024 %}
          {% else %}
            <div class="placeholder"><p>Nothing to see</p></div>
          {% endif %}
          <p>
            {{ project.templateContent | abstract | safe }}
          </p>
          <a href="{{ project.url }}">read more</a> 
          </div>
      </div>
    {%- endfor -%}
  </div>
  {% include "uplink.njk" %}
</div>

<script>
  window.addEventListener("load", function() {
    const projectList = document.getElementById("project-list")
    const projectItems = Array.from(document.getElementsByClassName("project-list-item"))
      .map((item) => {
        return { 
          scrollPosition: item.offsetTop - projectList.offsetHeight/2,
          color: item.getAttribute("data-color")
        }
      })

    function changeTheme() {
      for (const item of projectItems) {
        if (projectList.scrollTop > item.scrollPosition) {
          projectList.className = "color-"+item.color
        } else {
          break
        }
      }
    }
    changeTheme()
    projectList.addEventListener("scroll", throttle(changeTheme, 250))
  })
</script>